---
title: https 的安全问题
date: 2017-09-19 11:50:24
tags:
---
## 中间人攻击

你和服务器的连接会经过一个中间人，你以为你和服务器在正常地传输入数据，其实这些数据都先经过了一个中间人，这个中间人可以窥探你的数据或者篡改你的数据后再发给服务器，相反也可以把服务器的数据修改了之后再发给你。而这个中间人对你是透明的，你不知道你的数据已经被人窃取或者修改了。

>  与服务器交互的数据被劫持

## 中间人攻击方式

1. 域名污染

	* 由于我们访问一个域名时需要先进行域名解析，即向DNS服务器请求某个域名的IP地址。在经过DNS的中间链点可能会抢答，返回给你一个错误的IP地址，这个IP地址就指向中间人的机器。
	
2. APR欺骗

	* 如果路由器的 ARP 广播被同局域网的抢答, 那么实际发给你的数据包就会流向抢答机


## https连接的过程

1. client hello

	（1） 支持的协议版本，比如TLS 1.0版。

	（2） 一个客户端生成的随机数，稍后用于生成"对话密钥"。

	（3） 支持的加密方法，比如RSA公钥加密。

	（4） 支持的压缩方法。
2. server hello

3. Certificate证书
	
	* 服务器总共发来三个证书, 分别是加密证书, 签名证书, 和根证书
	* 每个证书包含签名, 签名的算法，和被签名的证书tbsCertificate(to be signed Certificate)
		* 证书又包含
			1. 申请证书时所填写的国家、省份、城市、组织名称
			2. 证书支持的域名
			3. 证书的有效期
			4. 证书的公钥
	
4. RSA加密和解密

5. 密钥交换Key Exchange

	

 
> ps:  降级攻击无法避免(人工避免)

[参考资料 野狗](https://mp.weixin.qq.com/s?__biz=MzI0ODA2ODU2NQ==&mid=2651131741&idx=1&sn=8d3d5b67bf7edbcd50e8a5308dc1fbe9&chksm=f257cfe7c52046f16decde9e1893b45a6eac14ea3e3a55270ec56764cb78ed4688304936e766&scene=21#wechat_redirect)

[参考资料 阮一峰](http://www.ruanyifeng.com/blog/2014/02/ssl_tls.html)